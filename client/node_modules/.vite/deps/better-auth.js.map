{
  "version": 3,
  "sources": ["../../../../node_modules/.bun/better-auth@1.4.10+2d8ddc2d470fbe56/node_modules/better-auth/src/utils/constants.ts", "../../../../node_modules/.bun/better-auth@1.4.10+2d8ddc2d470fbe56/node_modules/better-auth/src/utils/is-promise.ts", "../../../../node_modules/.bun/better-auth@1.4.10+2d8ddc2d470fbe56/node_modules/better-auth/src/context/helpers.ts", "../../../../node_modules/.bun/@better-auth+telemetry@1.4.10+6c547600871152fa/node_modules/@better-auth/telemetry/dist/index.mjs", "../../../../node_modules/.bun/better-auth@1.4.10+2d8ddc2d470fbe56/node_modules/better-auth/src/context/create-context.ts", "../../../../node_modules/.bun/better-auth@1.4.10+2d8ddc2d470fbe56/node_modules/better-auth/src/context/init.ts", "../../../../node_modules/.bun/better-auth@1.4.10+2d8ddc2d470fbe56/node_modules/better-auth/src/auth/base.ts", "../../../../node_modules/.bun/better-auth@1.4.10+2d8ddc2d470fbe56/node_modules/better-auth/src/auth/auth.ts"],
  "sourcesContent": ["export const DEFAULT_SECRET = \"better-auth-secret-12345678901234567890\";\n", "export function isPromise(obj?: unknown): obj is Promise<unknown> {\n\treturn (\n\t\t!!obj &&\n\t\t(typeof obj === \"object\" || typeof obj === \"function\") &&\n\t\ttypeof (obj as Promise<unknown>).then === \"function\"\n\t);\n}\n", "import type {\n\tAuthContext,\n\tBetterAuthOptions,\n\tBetterAuthPlugin,\n} from \"@better-auth/core\";\nimport { env } from \"@better-auth/core/env\";\nimport { BetterAuthError } from \"@better-auth/core/error\";\nimport { defu } from \"defu\";\nimport { createInternalAdapter } from \"../db/internal-adapter\";\nimport { isPromise } from \"../utils/is-promise\";\nimport { getBaseURL } from \"../utils/url\";\n\nexport async function runPluginInit(ctx: AuthContext) {\n\tlet options = ctx.options;\n\tconst plugins = options.plugins || [];\n\tlet context: AuthContext = ctx;\n\tconst dbHooks: BetterAuthOptions[\"databaseHooks\"][] = [];\n\tfor (const plugin of plugins) {\n\t\tif (plugin.init) {\n\t\t\tlet initPromise = plugin.init(context);\n\t\t\tlet result: ReturnType<Required<BetterAuthPlugin>[\"init\"]>;\n\t\t\tif (isPromise(initPromise)) {\n\t\t\t\tresult = await initPromise;\n\t\t\t} else {\n\t\t\t\tresult = initPromise;\n\t\t\t}\n\t\t\tif (typeof result === \"object\") {\n\t\t\t\tif (result.options) {\n\t\t\t\t\tconst { databaseHooks, ...restOpts } = result.options;\n\t\t\t\t\tif (databaseHooks) {\n\t\t\t\t\t\tdbHooks.push(databaseHooks);\n\t\t\t\t\t}\n\t\t\t\t\toptions = defu(options, restOpts);\n\t\t\t\t}\n\t\t\t\tif (result.context) {\n\t\t\t\t\tcontext = {\n\t\t\t\t\t\t...context,\n\t\t\t\t\t\t...(result.context as Partial<AuthContext>),\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t// Add the global database hooks last\n\tdbHooks.push(options.databaseHooks);\n\tcontext.internalAdapter = createInternalAdapter(context.adapter, {\n\t\toptions,\n\t\tlogger: context.logger,\n\t\thooks: dbHooks.filter((u) => u !== undefined),\n\t\tgenerateId: context.generateId,\n\t});\n\tcontext.options = options;\n\treturn { context };\n}\n\nexport function getInternalPlugins(options: BetterAuthOptions) {\n\tconst plugins: BetterAuthPlugin[] = [];\n\tif (options.advanced?.crossSubDomainCookies?.enabled) {\n\t\t// TODO: add internal plugin\n\t}\n\treturn plugins;\n}\n\nexport async function getTrustedOrigins(\n\toptions: BetterAuthOptions,\n\trequest?: Request,\n) {\n\tconst baseURL = getBaseURL(options.baseURL, options.basePath);\n\tconst trustedOrigins = baseURL ? [new URL(baseURL).origin] : [];\n\tif (options.trustedOrigins) {\n\t\tif (Array.isArray(options.trustedOrigins)) {\n\t\t\ttrustedOrigins.push(...options.trustedOrigins);\n\t\t}\n\t\tif (typeof options.trustedOrigins === \"function\") {\n\t\t\ttrustedOrigins.push(...(await options.trustedOrigins(request)));\n\t\t}\n\t}\n\tconst envTrustedOrigins = env.BETTER_AUTH_TRUSTED_ORIGINS;\n\tif (envTrustedOrigins) {\n\t\ttrustedOrigins.push(...envTrustedOrigins.split(\",\"));\n\t}\n\tif (trustedOrigins.filter((x) => !x).length) {\n\t\tthrow new BetterAuthError(\n\t\t\t\"A provided trusted origin is invalid, make sure your trusted origins list is properly defined.\",\n\t\t);\n\t}\n\treturn trustedOrigins;\n}\n", "import { ENV, env, getBooleanEnvVar, getEnvVar, isTest, logger } from \"@better-auth/core/env\";\nimport { betterFetch } from \"@better-fetch/fetch\";\nimport { base64 } from \"@better-auth/utils/base64\";\nimport { createHash } from \"@better-auth/utils/hash\";\nimport { createRandomStringGenerator } from \"@better-auth/utils/random\";\n\n//#region src/detectors/detect-auth-config.ts\nfunction getTelemetryAuthConfig(options, context) {\n\treturn {\n\t\tdatabase: context?.database,\n\t\tadapter: context?.adapter,\n\t\temailVerification: {\n\t\t\tsendVerificationEmail: !!options.emailVerification?.sendVerificationEmail,\n\t\t\tsendOnSignUp: !!options.emailVerification?.sendOnSignUp,\n\t\t\tsendOnSignIn: !!options.emailVerification?.sendOnSignIn,\n\t\t\tautoSignInAfterVerification: !!options.emailVerification?.autoSignInAfterVerification,\n\t\t\texpiresIn: options.emailVerification?.expiresIn,\n\t\t\tonEmailVerification: !!options.emailVerification?.onEmailVerification,\n\t\t\tafterEmailVerification: !!options.emailVerification?.afterEmailVerification\n\t\t},\n\t\temailAndPassword: {\n\t\t\tenabled: !!options.emailAndPassword?.enabled,\n\t\t\tdisableSignUp: !!options.emailAndPassword?.disableSignUp,\n\t\t\trequireEmailVerification: !!options.emailAndPassword?.requireEmailVerification,\n\t\t\tmaxPasswordLength: options.emailAndPassword?.maxPasswordLength,\n\t\t\tminPasswordLength: options.emailAndPassword?.minPasswordLength,\n\t\t\tsendResetPassword: !!options.emailAndPassword?.sendResetPassword,\n\t\t\tresetPasswordTokenExpiresIn: options.emailAndPassword?.resetPasswordTokenExpiresIn,\n\t\t\tonPasswordReset: !!options.emailAndPassword?.onPasswordReset,\n\t\t\tpassword: {\n\t\t\t\thash: !!options.emailAndPassword?.password?.hash,\n\t\t\t\tverify: !!options.emailAndPassword?.password?.verify\n\t\t\t},\n\t\t\tautoSignIn: !!options.emailAndPassword?.autoSignIn,\n\t\t\trevokeSessionsOnPasswordReset: !!options.emailAndPassword?.revokeSessionsOnPasswordReset\n\t\t},\n\t\tsocialProviders: Object.keys(options.socialProviders || {}).map((p) => {\n\t\t\tconst provider = options.socialProviders?.[p];\n\t\t\tif (!provider) return {};\n\t\t\treturn {\n\t\t\t\tid: p,\n\t\t\t\tmapProfileToUser: !!provider.mapProfileToUser,\n\t\t\t\tdisableDefaultScope: !!provider.disableDefaultScope,\n\t\t\t\tdisableIdTokenSignIn: !!provider.disableIdTokenSignIn,\n\t\t\t\tdisableImplicitSignUp: provider.disableImplicitSignUp,\n\t\t\t\tdisableSignUp: provider.disableSignUp,\n\t\t\t\tgetUserInfo: !!provider.getUserInfo,\n\t\t\t\toverrideUserInfoOnSignIn: !!provider.overrideUserInfoOnSignIn,\n\t\t\t\tprompt: provider.prompt,\n\t\t\t\tverifyIdToken: !!provider.verifyIdToken,\n\t\t\t\tscope: provider.scope,\n\t\t\t\trefreshAccessToken: !!provider.refreshAccessToken\n\t\t\t};\n\t\t}),\n\t\tplugins: options.plugins?.map((p) => p.id.toString()),\n\t\tuser: {\n\t\t\tmodelName: options.user?.modelName,\n\t\t\tfields: options.user?.fields,\n\t\t\tadditionalFields: options.user?.additionalFields,\n\t\t\tchangeEmail: {\n\t\t\t\tenabled: options.user?.changeEmail?.enabled,\n\t\t\t\tsendChangeEmailVerification: !!options.user?.changeEmail?.sendChangeEmailVerification\n\t\t\t}\n\t\t},\n\t\tverification: {\n\t\t\tmodelName: options.verification?.modelName,\n\t\t\tdisableCleanup: options.verification?.disableCleanup,\n\t\t\tfields: options.verification?.fields\n\t\t},\n\t\tsession: {\n\t\t\tmodelName: options.session?.modelName,\n\t\t\tadditionalFields: options.session?.additionalFields,\n\t\t\tcookieCache: {\n\t\t\t\tenabled: options.session?.cookieCache?.enabled,\n\t\t\t\tmaxAge: options.session?.cookieCache?.maxAge,\n\t\t\t\tstrategy: options.session?.cookieCache?.strategy\n\t\t\t},\n\t\t\tdisableSessionRefresh: options.session?.disableSessionRefresh,\n\t\t\texpiresIn: options.session?.expiresIn,\n\t\t\tfields: options.session?.fields,\n\t\t\tfreshAge: options.session?.freshAge,\n\t\t\tpreserveSessionInDatabase: options.session?.preserveSessionInDatabase,\n\t\t\tstoreSessionInDatabase: options.session?.storeSessionInDatabase,\n\t\t\tupdateAge: options.session?.updateAge\n\t\t},\n\t\taccount: {\n\t\t\tmodelName: options.account?.modelName,\n\t\t\tfields: options.account?.fields,\n\t\t\tencryptOAuthTokens: options.account?.encryptOAuthTokens,\n\t\t\tupdateAccountOnSignIn: options.account?.updateAccountOnSignIn,\n\t\t\taccountLinking: {\n\t\t\t\tenabled: options.account?.accountLinking?.enabled,\n\t\t\t\ttrustedProviders: options.account?.accountLinking?.trustedProviders,\n\t\t\t\tupdateUserInfoOnLink: options.account?.accountLinking?.updateUserInfoOnLink,\n\t\t\t\tallowUnlinkingAll: options.account?.accountLinking?.allowUnlinkingAll\n\t\t\t}\n\t\t},\n\t\thooks: {\n\t\t\tafter: !!options.hooks?.after,\n\t\t\tbefore: !!options.hooks?.before\n\t\t},\n\t\tsecondaryStorage: !!options.secondaryStorage,\n\t\tadvanced: {\n\t\t\tcookiePrefix: !!options.advanced?.cookiePrefix,\n\t\t\tcookies: !!options.advanced?.cookies,\n\t\t\tcrossSubDomainCookies: {\n\t\t\t\tdomain: !!options.advanced?.crossSubDomainCookies?.domain,\n\t\t\t\tenabled: options.advanced?.crossSubDomainCookies?.enabled,\n\t\t\t\tadditionalCookies: options.advanced?.crossSubDomainCookies?.additionalCookies\n\t\t\t},\n\t\t\tdatabase: {\n\t\t\t\tuseNumberId: !!options.advanced?.database?.useNumberId || options.advanced?.database?.generateId === \"serial\",\n\t\t\t\tgenerateId: options.advanced?.database?.generateId,\n\t\t\t\tdefaultFindManyLimit: options.advanced?.database?.defaultFindManyLimit\n\t\t\t},\n\t\t\tuseSecureCookies: options.advanced?.useSecureCookies,\n\t\t\tipAddress: {\n\t\t\t\tdisableIpTracking: options.advanced?.ipAddress?.disableIpTracking,\n\t\t\t\tipAddressHeaders: options.advanced?.ipAddress?.ipAddressHeaders\n\t\t\t},\n\t\t\tdisableCSRFCheck: options.advanced?.disableCSRFCheck,\n\t\t\tcookieAttributes: {\n\t\t\t\texpires: options.advanced?.defaultCookieAttributes?.expires,\n\t\t\t\tsecure: options.advanced?.defaultCookieAttributes?.secure,\n\t\t\t\tsameSite: options.advanced?.defaultCookieAttributes?.sameSite,\n\t\t\t\tdomain: !!options.advanced?.defaultCookieAttributes?.domain,\n\t\t\t\tpath: options.advanced?.defaultCookieAttributes?.path,\n\t\t\t\thttpOnly: options.advanced?.defaultCookieAttributes?.httpOnly\n\t\t\t}\n\t\t},\n\t\ttrustedOrigins: options.trustedOrigins?.length,\n\t\trateLimit: {\n\t\t\tstorage: options.rateLimit?.storage,\n\t\t\tmodelName: options.rateLimit?.modelName,\n\t\t\twindow: options.rateLimit?.window,\n\t\t\tcustomStorage: !!options.rateLimit?.customStorage,\n\t\t\tenabled: options.rateLimit?.enabled,\n\t\t\tmax: options.rateLimit?.max\n\t\t},\n\t\tonAPIError: {\n\t\t\terrorURL: options.onAPIError?.errorURL,\n\t\t\tonError: !!options.onAPIError?.onError,\n\t\t\tthrow: options.onAPIError?.throw\n\t\t},\n\t\tlogger: {\n\t\t\tdisabled: options.logger?.disabled,\n\t\t\tlevel: options.logger?.level,\n\t\t\tlog: !!options.logger?.log\n\t\t},\n\t\tdatabaseHooks: {\n\t\t\tuser: {\n\t\t\t\tcreate: {\n\t\t\t\t\tafter: !!options.databaseHooks?.user?.create?.after,\n\t\t\t\t\tbefore: !!options.databaseHooks?.user?.create?.before\n\t\t\t\t},\n\t\t\t\tupdate: {\n\t\t\t\t\tafter: !!options.databaseHooks?.user?.update?.after,\n\t\t\t\t\tbefore: !!options.databaseHooks?.user?.update?.before\n\t\t\t\t}\n\t\t\t},\n\t\t\tsession: {\n\t\t\t\tcreate: {\n\t\t\t\t\tafter: !!options.databaseHooks?.session?.create?.after,\n\t\t\t\t\tbefore: !!options.databaseHooks?.session?.create?.before\n\t\t\t\t},\n\t\t\t\tupdate: {\n\t\t\t\t\tafter: !!options.databaseHooks?.session?.update?.after,\n\t\t\t\t\tbefore: !!options.databaseHooks?.session?.update?.before\n\t\t\t\t}\n\t\t\t},\n\t\t\taccount: {\n\t\t\t\tcreate: {\n\t\t\t\t\tafter: !!options.databaseHooks?.account?.create?.after,\n\t\t\t\t\tbefore: !!options.databaseHooks?.account?.create?.before\n\t\t\t\t},\n\t\t\t\tupdate: {\n\t\t\t\t\tafter: !!options.databaseHooks?.account?.update?.after,\n\t\t\t\t\tbefore: !!options.databaseHooks?.account?.update?.before\n\t\t\t\t}\n\t\t\t},\n\t\t\tverification: {\n\t\t\t\tcreate: {\n\t\t\t\t\tafter: !!options.databaseHooks?.verification?.create?.after,\n\t\t\t\t\tbefore: !!options.databaseHooks?.verification?.create?.before\n\t\t\t\t},\n\t\t\t\tupdate: {\n\t\t\t\t\tafter: !!options.databaseHooks?.verification?.update?.after,\n\t\t\t\t\tbefore: !!options.databaseHooks?.verification?.update?.before\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n}\n\n//#endregion\n//#region src/utils/package-json.ts\nlet packageJSONCache;\nasync function readRootPackageJson() {\n\tif (packageJSONCache) return packageJSONCache;\n\ttry {\n\t\tconst cwd = typeof process !== \"undefined\" && typeof process.cwd === \"function\" ? process.cwd() : \"\";\n\t\tif (!cwd) return void 0;\n\t\tconst importRuntime$1 = (m) => Function(\"mm\", \"return import(mm)\")(m);\n\t\tconst [{ default: fs }, { default: path }] = await Promise.all([importRuntime$1(\"fs/promises\"), importRuntime$1(\"path\")]);\n\t\tconst raw = await fs.readFile(path.join(cwd, \"package.json\"), \"utf-8\");\n\t\tpackageJSONCache = JSON.parse(raw);\n\t\treturn packageJSONCache;\n\t} catch {}\n}\nasync function getPackageVersion(pkg) {\n\tif (packageJSONCache) return packageJSONCache.dependencies?.[pkg] || packageJSONCache.devDependencies?.[pkg] || packageJSONCache.peerDependencies?.[pkg];\n\ttry {\n\t\tconst cwd = typeof process !== \"undefined\" && typeof process.cwd === \"function\" ? process.cwd() : \"\";\n\t\tif (!cwd) throw new Error(\"no-cwd\");\n\t\tconst importRuntime$1 = (m) => Function(\"mm\", \"return import(mm)\")(m);\n\t\tconst [{ default: fs }, { default: path }] = await Promise.all([importRuntime$1(\"fs/promises\"), importRuntime$1(\"path\")]);\n\t\tconst pkgJsonPath = path.join(cwd, \"node_modules\", pkg, \"package.json\");\n\t\tconst raw = await fs.readFile(pkgJsonPath, \"utf-8\");\n\t\treturn JSON.parse(raw).version || await getVersionFromLocalPackageJson(pkg) || void 0;\n\t} catch {}\n\treturn await getVersionFromLocalPackageJson(pkg);\n}\nasync function getVersionFromLocalPackageJson(pkg) {\n\tconst json = await readRootPackageJson();\n\tif (!json) return void 0;\n\treturn {\n\t\t...json.dependencies,\n\t\t...json.devDependencies,\n\t\t...json.peerDependencies\n\t}[pkg];\n}\nasync function getNameFromLocalPackageJson() {\n\treturn (await readRootPackageJson())?.name;\n}\n\n//#endregion\n//#region src/detectors/detect-database.ts\nconst DATABASES = {\n\tpg: \"postgresql\",\n\tmysql: \"mysql\",\n\tmariadb: \"mariadb\",\n\tsqlite3: \"sqlite\",\n\t\"better-sqlite3\": \"sqlite\",\n\t\"@prisma/client\": \"prisma\",\n\tmongoose: \"mongodb\",\n\tmongodb: \"mongodb\",\n\t\"drizzle-orm\": \"drizzle\"\n};\nasync function detectDatabase() {\n\tfor (const [pkg, name] of Object.entries(DATABASES)) {\n\t\tconst version = await getPackageVersion(pkg);\n\t\tif (version) return {\n\t\t\tname,\n\t\t\tversion\n\t\t};\n\t}\n}\n\n//#endregion\n//#region src/detectors/detect-framework.ts\nconst FRAMEWORKS = {\n\tnext: \"next\",\n\tnuxt: \"nuxt\",\n\t\"@remix-run/server-runtime\": \"remix\",\n\tastro: \"astro\",\n\t\"@sveltejs/kit\": \"sveltekit\",\n\t\"solid-start\": \"solid-start\",\n\t\"tanstack-start\": \"tanstack-start\",\n\thono: \"hono\",\n\texpress: \"express\",\n\telysia: \"elysia\",\n\texpo: \"expo\"\n};\nasync function detectFramework() {\n\tfor (const [pkg, name] of Object.entries(FRAMEWORKS)) {\n\t\tconst version = await getPackageVersion(pkg);\n\t\tif (version) return {\n\t\t\tname,\n\t\t\tversion\n\t\t};\n\t}\n}\n\n//#endregion\n//#region src/detectors/detect-project-info.ts\nfunction detectPackageManager() {\n\tconst userAgent = env.npm_config_user_agent;\n\tif (!userAgent) return;\n\tconst pmSpec = userAgent.split(\" \")[0];\n\tconst separatorPos = pmSpec.lastIndexOf(\"/\");\n\tconst name = pmSpec.substring(0, separatorPos);\n\treturn {\n\t\tname: name === \"npminstall\" ? \"cnpm\" : name,\n\t\tversion: pmSpec.substring(separatorPos + 1)\n\t};\n}\n\n//#endregion\n//#region src/utils/import-util.ts\nconst importRuntime = (m) => {\n\treturn Function(\"mm\", \"return import(mm)\")(m);\n};\n\n//#endregion\n//#region src/detectors/detect-system-info.ts\nfunction getVendor() {\n\tconst hasAny = (...keys) => keys.some((k) => Boolean(env[k]));\n\tif (hasAny(\"CF_PAGES\", \"CF_PAGES_URL\", \"CF_ACCOUNT_ID\") || typeof navigator !== \"undefined\" && navigator.userAgent === \"Cloudflare-Workers\") return \"cloudflare\";\n\tif (hasAny(\"VERCEL\", \"VERCEL_URL\", \"VERCEL_ENV\")) return \"vercel\";\n\tif (hasAny(\"NETLIFY\", \"NETLIFY_URL\")) return \"netlify\";\n\tif (hasAny(\"RENDER\", \"RENDER_URL\", \"RENDER_INTERNAL_HOSTNAME\", \"RENDER_SERVICE_ID\")) return \"render\";\n\tif (hasAny(\"AWS_LAMBDA_FUNCTION_NAME\", \"AWS_EXECUTION_ENV\", \"LAMBDA_TASK_ROOT\")) return \"aws\";\n\tif (hasAny(\"GOOGLE_CLOUD_FUNCTION_NAME\", \"GOOGLE_CLOUD_PROJECT\", \"GCP_PROJECT\", \"K_SERVICE\")) return \"gcp\";\n\tif (hasAny(\"AZURE_FUNCTION_NAME\", \"FUNCTIONS_WORKER_RUNTIME\", \"WEBSITE_INSTANCE_ID\", \"WEBSITE_SITE_NAME\")) return \"azure\";\n\tif (hasAny(\"DENO_DEPLOYMENT_ID\", \"DENO_REGION\")) return \"deno-deploy\";\n\tif (hasAny(\"FLY_APP_NAME\", \"FLY_REGION\", \"FLY_ALLOC_ID\")) return \"fly-io\";\n\tif (hasAny(\"RAILWAY_STATIC_URL\", \"RAILWAY_ENVIRONMENT_NAME\")) return \"railway\";\n\tif (hasAny(\"DYNO\", \"HEROKU_APP_NAME\")) return \"heroku\";\n\tif (hasAny(\"DO_DEPLOYMENT_ID\", \"DO_APP_NAME\", \"DIGITALOCEAN\")) return \"digitalocean\";\n\tif (hasAny(\"KOYEB\", \"KOYEB_DEPLOYMENT_ID\", \"KOYEB_APP_NAME\")) return \"koyeb\";\n\treturn null;\n}\nasync function detectSystemInfo() {\n\ttry {\n\t\tif (getVendor() === \"cloudflare\") return \"cloudflare\";\n\t\tconst os = await importRuntime(\"os\");\n\t\tconst cpus = os.cpus();\n\t\treturn {\n\t\t\tdeploymentVendor: getVendor(),\n\t\t\tsystemPlatform: os.platform(),\n\t\t\tsystemRelease: os.release(),\n\t\t\tsystemArchitecture: os.arch(),\n\t\t\tcpuCount: cpus.length,\n\t\t\tcpuModel: cpus.length ? cpus[0].model : null,\n\t\t\tcpuSpeed: cpus.length ? cpus[0].speed : null,\n\t\t\tmemory: os.totalmem(),\n\t\t\tisWSL: await isWsl(),\n\t\t\tisDocker: await isDocker(),\n\t\t\tisTTY: typeof process !== \"undefined\" && process.stdout ? process.stdout.isTTY : null\n\t\t};\n\t} catch {\n\t\treturn {\n\t\t\tsystemPlatform: null,\n\t\t\tsystemRelease: null,\n\t\t\tsystemArchitecture: null,\n\t\t\tcpuCount: null,\n\t\t\tcpuModel: null,\n\t\t\tcpuSpeed: null,\n\t\t\tmemory: null,\n\t\t\tisWSL: null,\n\t\t\tisDocker: null,\n\t\t\tisTTY: null\n\t\t};\n\t}\n}\nlet isDockerCached;\nasync function hasDockerEnv() {\n\tif (getVendor() === \"cloudflare\") return false;\n\ttry {\n\t\t(await importRuntime(\"fs\")).statSync(\"/.dockerenv\");\n\t\treturn true;\n\t} catch {\n\t\treturn false;\n\t}\n}\nasync function hasDockerCGroup() {\n\tif (getVendor() === \"cloudflare\") return false;\n\ttry {\n\t\treturn (await importRuntime(\"fs\")).readFileSync(\"/proc/self/cgroup\", \"utf8\").includes(\"docker\");\n\t} catch {\n\t\treturn false;\n\t}\n}\nasync function isDocker() {\n\tif (getVendor() === \"cloudflare\") return false;\n\tif (isDockerCached === void 0) isDockerCached = await hasDockerEnv() || await hasDockerCGroup();\n\treturn isDockerCached;\n}\nasync function isWsl() {\n\ttry {\n\t\tif (getVendor() === \"cloudflare\") return false;\n\t\tif (typeof process === \"undefined\" || process?.platform !== \"linux\") return false;\n\t\tconst fs = await importRuntime(\"fs\");\n\t\tif ((await importRuntime(\"os\")).release().toLowerCase().includes(\"microsoft\")) {\n\t\t\tif (await isInsideContainer()) return false;\n\t\t\treturn true;\n\t\t}\n\t\treturn fs.readFileSync(\"/proc/version\", \"utf8\").toLowerCase().includes(\"microsoft\") ? !await isInsideContainer() : false;\n\t} catch {\n\t\treturn false;\n\t}\n}\nlet isInsideContainerCached;\nconst hasContainerEnv = async () => {\n\tif (getVendor() === \"cloudflare\") return false;\n\ttry {\n\t\t(await importRuntime(\"fs\")).statSync(\"/run/.containerenv\");\n\t\treturn true;\n\t} catch {\n\t\treturn false;\n\t}\n};\nasync function isInsideContainer() {\n\tif (isInsideContainerCached === void 0) isInsideContainerCached = await hasContainerEnv() || await isDocker();\n\treturn isInsideContainerCached;\n}\nfunction isCI() {\n\treturn env.CI !== \"false\" && (\"BUILD_ID\" in env || \"BUILD_NUMBER\" in env || \"CI\" in env || \"CI_APP_ID\" in env || \"CI_BUILD_ID\" in env || \"CI_BUILD_NUMBER\" in env || \"CI_NAME\" in env || \"CONTINUOUS_INTEGRATION\" in env || \"RUN_ID\" in env);\n}\n\n//#endregion\n//#region src/detectors/detect-runtime.ts\nfunction detectRuntime() {\n\tif (typeof Deno !== \"undefined\") return {\n\t\tname: \"deno\",\n\t\tversion: Deno?.version?.deno ?? null\n\t};\n\tif (typeof Bun !== \"undefined\") return {\n\t\tname: \"bun\",\n\t\tversion: Bun?.version ?? null\n\t};\n\tif (typeof process !== \"undefined\" && process?.versions?.node) return {\n\t\tname: \"node\",\n\t\tversion: process.versions.node ?? null\n\t};\n\treturn {\n\t\tname: \"edge\",\n\t\tversion: null\n\t};\n}\nfunction detectEnvironment() {\n\treturn getEnvVar(\"NODE_ENV\") === \"production\" ? \"production\" : isCI() ? \"ci\" : isTest() ? \"test\" : \"development\";\n}\n\n//#endregion\n//#region src/utils/hash.ts\nasync function hashToBase64(data) {\n\tconst buffer = await createHash(\"SHA-256\").digest(data);\n\treturn base64.encode(buffer);\n}\n\n//#endregion\n//#region src/utils/id.ts\nconst generateId = (size) => {\n\treturn createRandomStringGenerator(\"a-z\", \"A-Z\", \"0-9\")(size || 32);\n};\n\n//#endregion\n//#region src/project-id.ts\nlet projectIdCached = null;\nasync function getProjectId(baseUrl) {\n\tif (projectIdCached) return projectIdCached;\n\tconst projectName = await getNameFromLocalPackageJson();\n\tif (projectName) {\n\t\tprojectIdCached = await hashToBase64(baseUrl ? baseUrl + projectName : projectName);\n\t\treturn projectIdCached;\n\t}\n\tif (baseUrl) {\n\t\tprojectIdCached = await hashToBase64(baseUrl);\n\t\treturn projectIdCached;\n\t}\n\tprojectIdCached = generateId(32);\n\treturn projectIdCached;\n}\n\n//#endregion\n//#region src/index.ts\nasync function createTelemetry(options, context) {\n\tconst debugEnabled = options.telemetry?.debug || getBooleanEnvVar(\"BETTER_AUTH_TELEMETRY_DEBUG\", false);\n\tconst TELEMETRY_ENDPOINT = ENV.BETTER_AUTH_TELEMETRY_ENDPOINT;\n\tconst track = async (event) => {\n\t\tif (context?.customTrack) await context.customTrack(event).catch(logger.error);\n\t\telse if (debugEnabled) logger.info(\"telemetry event\", JSON.stringify(event, null, 2));\n\t\telse await betterFetch(TELEMETRY_ENDPOINT, {\n\t\t\tmethod: \"POST\",\n\t\t\tbody: event\n\t\t}).catch(logger.error);\n\t};\n\tconst isEnabled = async () => {\n\t\tconst telemetryEnabled = options.telemetry?.enabled !== void 0 ? options.telemetry.enabled : false;\n\t\treturn (getBooleanEnvVar(\"BETTER_AUTH_TELEMETRY\", false) || telemetryEnabled) && (context?.skipTestCheck || !isTest());\n\t};\n\tconst enabled = await isEnabled();\n\tlet anonymousId;\n\tif (enabled) {\n\t\tanonymousId = await getProjectId(options.baseURL);\n\t\ttrack({\n\t\t\ttype: \"init\",\n\t\t\tpayload: {\n\t\t\t\tconfig: getTelemetryAuthConfig(options, context),\n\t\t\t\truntime: detectRuntime(),\n\t\t\t\tdatabase: await detectDatabase(),\n\t\t\t\tframework: await detectFramework(),\n\t\t\t\tenvironment: detectEnvironment(),\n\t\t\t\tsystemInfo: await detectSystemInfo(),\n\t\t\t\tpackageManager: detectPackageManager()\n\t\t\t},\n\t\t\tanonymousId\n\t\t});\n\t}\n\treturn { publish: async (event) => {\n\t\tif (!enabled) return;\n\t\tif (!anonymousId) anonymousId = await getProjectId(options.baseURL);\n\t\tawait track({\n\t\t\ttype: event.type,\n\t\t\tpayload: event.payload,\n\t\t\tanonymousId\n\t\t});\n\t} };\n}\n\n//#endregion\nexport { createTelemetry, getTelemetryAuthConfig };", "import type { AuthContext, BetterAuthOptions } from \"@better-auth/core\";\nimport { getAuthTables } from \"@better-auth/core/db\";\nimport type { DBAdapter } from \"@better-auth/core/db/adapter\";\nimport { createLogger, env, isProduction, isTest } from \"@better-auth/core/env\";\nimport { BetterAuthError } from \"@better-auth/core/error\";\nimport type { OAuthProvider } from \"@better-auth/core/oauth2\";\nimport type { SocialProviders } from \"@better-auth/core/social-providers\";\nimport { socialProviders } from \"@better-auth/core/social-providers\";\nimport { createTelemetry } from \"@better-auth/telemetry\";\nimport defu from \"defu\";\nimport type { Entries } from \"type-fest\";\nimport { checkEndpointConflicts } from \"../api\";\nimport { matchesOriginPattern } from \"../auth/trusted-origins\";\nimport { createCookieGetter, getCookies } from \"../cookies\";\nimport { hashPassword, verifyPassword } from \"../crypto/password\";\nimport { createInternalAdapter } from \"../db/internal-adapter\";\nimport { generateId } from \"../utils\";\nimport { DEFAULT_SECRET } from \"../utils/constants\";\nimport { isPromise } from \"../utils/is-promise\";\nimport { checkPassword } from \"../utils/password\";\nimport { getBaseURL } from \"../utils/url\";\nimport {\n\tgetInternalPlugins,\n\tgetTrustedOrigins,\n\trunPluginInit,\n} from \"./helpers\";\n\n/**\n * Estimates the entropy of a string in bits.\n * This is a simple approximation that helps detect low-entropy secrets.\n */\nfunction estimateEntropy(str: string): number {\n\tconst unique = new Set(str).size;\n\tif (unique === 0) return 0;\n\treturn Math.log2(Math.pow(unique, str.length));\n}\n\n/**\n * Validates that the secret meets minimum security requirements.\n * Throws BetterAuthError if the secret is invalid.\n * Skips validation for DEFAULT_SECRET in test environments only.\n * Only throws for DEFAULT_SECRET in production environment.\n */\nfunction validateSecret(\n\tsecret: string,\n\tlogger: ReturnType<typeof createLogger>,\n): void {\n\tconst isDefaultSecret = secret === DEFAULT_SECRET;\n\n\tif (isTest()) {\n\t\treturn;\n\t}\n\n\tif (isDefaultSecret && isProduction) {\n\t\tthrow new BetterAuthError(\n\t\t\t\"You are using the default secret. Please set `BETTER_AUTH_SECRET` in your environment variables or pass `secret` in your auth config.\",\n\t\t);\n\t}\n\n\tif (!secret) {\n\t\tthrow new BetterAuthError(\n\t\t\t\"BETTER_AUTH_SECRET is missing. Set it in your environment or pass `secret` to betterAuth({ secret }).\",\n\t\t);\n\t}\n\n\tif (secret.length < 32) {\n\t\tlogger.warn(\n\t\t\t`[better-auth] Warning: your BETTER_AUTH_SECRET should be at least 32 characters long for adequate security. Generate one with \\`npx @better-auth/cli secret\\` or \\`openssl rand -base64 32\\`.`,\n\t\t);\n\t}\n\n\t// Optional high-entropy check: warn if entropy appears low\n\tconst entropy = estimateEntropy(secret);\n\tif (entropy < 120) {\n\t\tlogger.warn(\n\t\t\t\"[better-auth] Warning: your BETTER_AUTH_SECRET appears low-entropy. Use a randomly generated secret for production.\",\n\t\t);\n\t}\n}\n\nexport async function createAuthContext(\n\tadapter: DBAdapter<BetterAuthOptions>,\n\toptions: BetterAuthOptions,\n\tgetDatabaseType: (database: BetterAuthOptions[\"database\"]) => string,\n): Promise<AuthContext> {\n\t//set default options for stateless mode\n\tif (!options.database) {\n\t\toptions = defu(options, {\n\t\t\tsession: {\n\t\t\t\tcookieCache: {\n\t\t\t\t\tenabled: true,\n\t\t\t\t\tstrategy: \"jwe\" as const,\n\t\t\t\t\trefreshCache: true,\n\t\t\t\t},\n\t\t\t},\n\t\t\taccount: {\n\t\t\t\tstoreStateStrategy: \"cookie\" as const,\n\t\t\t\tstoreAccountCookie: true,\n\t\t\t},\n\t\t});\n\t}\n\tconst plugins = options.plugins || [];\n\tconst internalPlugins = getInternalPlugins(options);\n\tconst logger = createLogger(options.logger);\n\tconst baseURL = getBaseURL(options.baseURL, options.basePath);\n\n\tif (!baseURL) {\n\t\tlogger.warn(\n\t\t\t`[better-auth] Base URL could not be determined. Please set a valid base URL using the baseURL config option or the BETTER_AUTH_BASE_URL environment variable. Without this, callbacks and redirects may not work correctly.`,\n\t\t);\n\t}\n\n\tconst secret =\n\t\toptions.secret ||\n\t\tenv.BETTER_AUTH_SECRET ||\n\t\tenv.AUTH_SECRET ||\n\t\tDEFAULT_SECRET;\n\n\tvalidateSecret(secret, logger);\n\n\toptions = {\n\t\t...options,\n\t\tsecret,\n\t\tbaseURL: baseURL ? new URL(baseURL).origin : \"\",\n\t\tbasePath: options.basePath || \"/api/auth\",\n\t\tplugins: plugins.concat(internalPlugins),\n\t};\n\n\tcheckEndpointConflicts(options, logger);\n\tconst cookies = getCookies(options);\n\tconst tables = getAuthTables(options);\n\tconst providers: OAuthProvider[] = (\n\t\tObject.entries(\n\t\t\toptions.socialProviders || {},\n\t\t) as unknown as Entries<SocialProviders>\n\t)\n\t\t.map(([key, config]) => {\n\t\t\tif (config == null) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tif (config.enabled === false) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tif (!config.clientId) {\n\t\t\t\tlogger.warn(\n\t\t\t\t\t`Social provider ${key} is missing clientId or clientSecret`,\n\t\t\t\t);\n\t\t\t}\n\t\t\tconst provider = socialProviders[key](config as never);\n\t\t\t(provider as OAuthProvider).disableImplicitSignUp =\n\t\t\t\tconfig.disableImplicitSignUp;\n\t\t\treturn provider;\n\t\t})\n\t\t.filter((x) => x !== null);\n\n\tconst generateIdFunc: AuthContext[\"generateId\"] = ({ model, size }) => {\n\t\tif (typeof (options.advanced as any)?.generateId === \"function\") {\n\t\t\treturn (options.advanced as any).generateId({ model, size });\n\t\t}\n\t\tif (typeof options?.advanced?.database?.generateId === \"function\") {\n\t\t\treturn options.advanced.database.generateId({ model, size });\n\t\t}\n\t\treturn generateId(size);\n\t};\n\n\tconst { publish } = await createTelemetry(options, {\n\t\tadapter: adapter.id,\n\t\tdatabase:\n\t\t\ttypeof options.database === \"function\"\n\t\t\t\t? \"adapter\"\n\t\t\t\t: getDatabaseType(options.database),\n\t});\n\n\tlet ctx: AuthContext = {\n\t\tappName: options.appName || \"Better Auth\",\n\t\tsocialProviders: providers,\n\t\toptions,\n\t\toauthConfig: {\n\t\t\tstoreStateStrategy:\n\t\t\t\toptions.account?.storeStateStrategy ||\n\t\t\t\t(options.database ? \"database\" : \"cookie\"),\n\t\t\tskipStateCookieCheck: !!options.account?.skipStateCookieCheck,\n\t\t},\n\t\ttables,\n\t\ttrustedOrigins: await getTrustedOrigins(options),\n\t\tisTrustedOrigin(\n\t\t\turl: string,\n\t\t\tsettings?: {\n\t\t\t\tallowRelativePaths: boolean;\n\t\t\t},\n\t\t) {\n\t\t\treturn this.trustedOrigins.some((origin) =>\n\t\t\t\tmatchesOriginPattern(url, origin, settings),\n\t\t\t);\n\t\t},\n\t\tbaseURL: baseURL || \"\",\n\t\tsessionConfig: {\n\t\t\tupdateAge:\n\t\t\t\toptions.session?.updateAge !== undefined\n\t\t\t\t\t? options.session.updateAge\n\t\t\t\t\t: 24 * 60 * 60,\n\t\t\texpiresIn: options.session?.expiresIn || 60 * 60 * 24 * 7,\n\t\t\tfreshAge:\n\t\t\t\toptions.session?.freshAge === undefined\n\t\t\t\t\t? 60 * 60 * 24\n\t\t\t\t\t: options.session.freshAge,\n\t\t\tcookieRefreshCache: (() => {\n\t\t\t\tconst refreshCache = options.session?.cookieCache?.refreshCache;\n\t\t\t\tconst maxAge = options.session?.cookieCache?.maxAge || 60 * 5;\n\n\t\t\t\t// `refreshCache` is intended for fully stateless / DB-less setups.\n\t\t\t\t// If a server-side store is configured, prefer fetching/refreshing from that source\n\t\t\t\t// and disable stateless refresh behavior to avoid confusing/unsafe configurations.\n\t\t\t\tconst isStateful = !!options.database || !!options.secondaryStorage;\n\t\t\t\tif (isStateful && refreshCache) {\n\t\t\t\t\tlogger.warn(\n\t\t\t\t\t\t\"[better-auth] `session.cookieCache.refreshCache` is enabled while `database` or `secondaryStorage` is configured. `refreshCache` is meant for stateless (DB-less) setups. Disabling `refreshCache` â€” remove it from your config to silence this warning.\",\n\t\t\t\t\t);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (refreshCache === false || refreshCache === undefined) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (refreshCache === true) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tenabled: true,\n\t\t\t\t\t\tupdateAge: Math.floor(maxAge * 0.2),\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\treturn {\n\t\t\t\t\tenabled: true,\n\t\t\t\t\tupdateAge:\n\t\t\t\t\t\trefreshCache.updateAge !== undefined\n\t\t\t\t\t\t\t? refreshCache.updateAge\n\t\t\t\t\t\t\t: Math.floor(maxAge * 0.2),\n\t\t\t\t};\n\t\t\t})(),\n\t\t},\n\t\tsecret,\n\t\trateLimit: {\n\t\t\t...options.rateLimit,\n\t\t\tenabled: options.rateLimit?.enabled ?? isProduction,\n\t\t\twindow: options.rateLimit?.window || 10,\n\t\t\tmax: options.rateLimit?.max || 100,\n\t\t\tstorage:\n\t\t\t\toptions.rateLimit?.storage ||\n\t\t\t\t(options.secondaryStorage ? \"secondary-storage\" : \"memory\"),\n\t\t},\n\t\tauthCookies: cookies,\n\t\tlogger,\n\t\tgenerateId: generateIdFunc,\n\t\tsession: null,\n\t\tsecondaryStorage: options.secondaryStorage,\n\t\tpassword: {\n\t\t\thash: options.emailAndPassword?.password?.hash || hashPassword,\n\t\t\tverify: options.emailAndPassword?.password?.verify || verifyPassword,\n\t\t\tconfig: {\n\t\t\t\tminPasswordLength: options.emailAndPassword?.minPasswordLength || 8,\n\t\t\t\tmaxPasswordLength: options.emailAndPassword?.maxPasswordLength || 128,\n\t\t\t},\n\t\t\tcheckPassword,\n\t\t},\n\t\tsetNewSession(session) {\n\t\t\tthis.newSession = session;\n\t\t},\n\t\tnewSession: null,\n\t\tadapter: adapter,\n\t\tinternalAdapter: createInternalAdapter(adapter, {\n\t\t\toptions,\n\t\t\tlogger,\n\t\t\thooks: options.databaseHooks ? [options.databaseHooks] : [],\n\t\t\tgenerateId: generateIdFunc,\n\t\t}),\n\t\tcreateAuthCookie: createCookieGetter(options),\n\t\tasync runMigrations() {\n\t\t\tthrow new BetterAuthError(\n\t\t\t\t\"runMigrations will be set by the specific init implementation\",\n\t\t\t);\n\t\t},\n\t\tpublishTelemetry: publish,\n\t\tskipCSRFCheck: !!options.advanced?.disableCSRFCheck,\n\t\tskipOriginCheck:\n\t\t\toptions.advanced?.disableOriginCheck !== undefined\n\t\t\t\t? options.advanced.disableOriginCheck\n\t\t\t\t: isTest()\n\t\t\t\t\t? true\n\t\t\t\t\t: false,\n\t\trunInBackground:\n\t\t\toptions.advanced?.backgroundTasks?.handler ??\n\t\t\t((p) => {\n\t\t\t\tp.catch(() => {});\n\t\t\t}),\n\t\tasync runInBackgroundOrAwait(\n\t\t\tpromise: Promise<unknown> | Promise<void> | void | unknown,\n\t\t) {\n\t\t\ttry {\n\t\t\t\tif (options.advanced?.backgroundTasks?.handler) {\n\t\t\t\t\tif (promise instanceof Promise) {\n\t\t\t\t\t\toptions.advanced.backgroundTasks.handler(\n\t\t\t\t\t\t\tpromise.catch((e) => {\n\t\t\t\t\t\t\t\tlogger.error(\"Failed to run background task:\", e);\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tawait promise;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tlogger.error(\"Failed to run background task:\", e);\n\t\t\t}\n\t\t},\n\t};\n\n\tconst initOrPromise = runPluginInit(ctx);\n\tlet context: AuthContext;\n\tif (isPromise(initOrPromise)) {\n\t\t({ context } = await initOrPromise);\n\t} else {\n\t\t({ context } = initOrPromise);\n\t}\n\n\treturn context;\n}\n", "import { BetterAuthError } from \"@better-auth/core/error\";\nimport { getKyselyDatabaseType } from \"../adapters/kysely-adapter/dialect\";\nimport { getAdapter } from \"../db/adapter-kysely\";\nimport { getMigrations } from \"../db/get-migration\";\nimport type { BetterAuthOptions } from \"../types\";\nimport { createAuthContext } from \"./create-context\";\n\nexport const init = async (options: BetterAuthOptions) => {\n\tconst adapter = await getAdapter(options);\n\n\t// Get database type using Kysely's dialect detection\n\tconst getDatabaseType = (database: BetterAuthOptions[\"database\"]) =>\n\t\tgetKyselyDatabaseType(database) || \"unknown\";\n\n\t// Use base context creation\n\tconst ctx = await createAuthContext(adapter, options, getDatabaseType);\n\n\t// Add runMigrations with Kysely support\n\tctx.runMigrations = async function () {\n\t\t// only run migrations if database is provided and it's not an adapter\n\t\tif (!options.database || \"updateMany\" in options.database) {\n\t\t\tthrow new BetterAuthError(\n\t\t\t\t\"Database is not provided or it's an adapter. Migrations are only supported with a database instance.\",\n\t\t\t);\n\t\t}\n\t\tconst { runMigrations } = await getMigrations(options);\n\t\tawait runMigrations();\n\t};\n\n\treturn ctx;\n};\n", "import type { AuthContext, BetterAuthOptions } from \"@better-auth/core\";\nimport { runWithAdapter } from \"@better-auth/core/context\";\nimport { BASE_ERROR_CODES, BetterAuthError } from \"@better-auth/core/error\";\nimport { getEndpoints, router } from \"../api\";\nimport { getTrustedOrigins } from \"../context/helpers\";\nimport type { Auth } from \"../types\";\nimport { getBaseURL, getOrigin } from \"../utils/url\";\n\nexport const createBetterAuth = <Options extends BetterAuthOptions>(\n\toptions: Options &\n\t\t// fixme(alex): do we need Record<never, never> here?\n\t\tRecord<never, never>,\n\tinitFn: (options: Options) => Promise<AuthContext>,\n): Auth<Options> => {\n\tconst authContext = initFn(options);\n\tconst { api } = getEndpoints(authContext, options);\n\tconst errorCodes = options.plugins?.reduce((acc, plugin) => {\n\t\tif (plugin.$ERROR_CODES) {\n\t\t\treturn {\n\t\t\t\t...acc,\n\t\t\t\t...plugin.$ERROR_CODES,\n\t\t\t};\n\t\t}\n\t\treturn acc;\n\t}, {});\n\treturn {\n\t\thandler: async (request: Request) => {\n\t\t\tconst ctx = await authContext;\n\t\t\tconst basePath = ctx.options.basePath || \"/api/auth\";\n\t\t\tif (!ctx.options.baseURL) {\n\t\t\t\tconst baseURL = getBaseURL(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbasePath,\n\t\t\t\t\trequest,\n\t\t\t\t\tundefined,\n\t\t\t\t\tctx.options.advanced?.trustedProxyHeaders,\n\t\t\t\t);\n\t\t\t\tif (baseURL) {\n\t\t\t\t\tctx.baseURL = baseURL;\n\t\t\t\t\tctx.options.baseURL = getOrigin(ctx.baseURL) || undefined;\n\t\t\t\t} else {\n\t\t\t\t\tthrow new BetterAuthError(\n\t\t\t\t\t\t\"Could not get base URL from request. Please provide a valid base URL.\",\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\tctx.trustedOrigins = await getTrustedOrigins(ctx.options, request);\n\t\t\tconst { handler } = router(ctx, options);\n\t\t\treturn runWithAdapter(ctx.adapter, () => handler(request));\n\t\t},\n\t\tapi,\n\t\toptions: options,\n\t\t$context: authContext,\n\t\t$ERROR_CODES: {\n\t\t\t...errorCodes,\n\t\t\t...BASE_ERROR_CODES,\n\t\t},\n\t} as any;\n};\n", "import type { BetterAuthOptions } from \"@better-auth/core\";\nimport { init } from \"../context/init\";\nimport type { Auth } from \"../types\";\nimport { createBetterAuth } from \"./base\";\n\n/**\n * Better Auth initializer for full mode (with Kysely)\n *\n * @example\n * ```ts\n * import { betterAuth } from \"better-auth\";\n *\n * const auth = betterAuth({\n * \tdatabase: new PostgresDialect({ connection: process.env.DATABASE_URL }),\n * });\n * ```\n *\n * For minimal mode (without Kysely), import from `better-auth/minimal` instead\n * @example\n * ```ts\n * import { betterAuth } from \"better-auth/minimal\";\n *\n * const auth = betterAuth({\n *\t  database: drizzleAdapter(db, { provider: \"pg\" }),\n * });\n */\nexport const betterAuth = <Options extends BetterAuthOptions>(\n\toptions: Options & Record<never, never>,\n): Auth<Options> => {\n\treturn createBetterAuth(options, init);\n};\n"],
  "mappings": "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",
  "names": ["context: AuthContext", "dbHooks: BetterAuthOptions[\"databaseHooks\"][]", "result: ReturnType<Required<BetterAuthPlugin>[\"init\"]>", "plugins: BetterAuthPlugin[]", "generateId", "defu", "logger", "providers: OAuthProvider[]", "generateIdFunc: AuthContext[\"generateId\"]", "context: AuthContext"]
}
